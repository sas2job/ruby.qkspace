# Ruby: Как работает чтение из XML-файла?

**Вопрос**: Объясните пожалуйста почему в этом варианте выводит содержимое `xml`, но не выводит `readlines` (разница между двумя вариантами лишь в последовательности строк):

```ruby
file = File.new("vizitka.xml", "r:UTF-8")

doc = REXML::Document.new(file)

puts file.readlines

file.close

puts doc.root.elements["email"].text
```

А в этом варианте не выводит `xml`, но выводит содержимое файла через `readlines`:
```ruby
file = File.new("vizitka.xml", "r:UTF-8")

puts file.readlines

doc = REXML::Document.new(file)

file.close

puts doc.root.elements["email"].text
```

Ответ: Когда мы открываем файл мы сообщаем, в каком режиме мы хотим открыть файл. В данном случай, мы в аргументах передаём "флажок" r (тот, который прописан перед указанием кодировки), который, если расшифровать его на «русский язык» сообщает компьютеру следующее: «Компьютер, открой этот файл и установи "виртуальный" курсор в начало файла» (англ. pointer - курсор/указатель). В дальнейшем чтение из файла осуществляется с позиции курсора. В более низкоуровневых языках программирования пришлось бы даже писать целый цикл, чтобы считать содержание файла с проверкой, не дошли ли мы до конца файла.

В Ruby же есть есть метод `readlines` который считывает весь файл в массив строк, при этом в процессе чтения файла наш виртуальный курсор перемещается в самый-самый конец файла и остается там, если специальными методами его не переместить обратно. Получается, когда вы передаёте дальше переменную файл, XML-парсер получает её и тоже пытается заложенным в нём способом прочитать содержимое файла, но т.к. виртуальный курсор уже в конце файла, повторно пытаясь его прочесть XML-парсер на вход не получает ничего - ведь между позицией виртуального курсора и концов файла ничего нет.

Чтобы прочитать файл повторно, нужно заного установить курсор в начало файла, один из способов (который нагуглился) - `file.seek 0` - условно, «установи курсор на байт номер 0» (т.е. в начало).
